<!DOCTYPE html>
<head>
    <script src="https://d3js.org/d3.v7.js"></script>
    <style>
        .graph{
            margin: auto;
            align-items: center;
            text-align: center;
        }
    </style>
</head>
<html>
    <body>
        <div class = "graph">
            <h2 id = "title">Doping in Professional Bicycle Racing</h2>
            <h3>35 Fastest times up Alpe d'Huez</h3>
            <script>
                const req = new XMLHttpRequest()
                req.open('GET', 'https://raw.githubusercontent.com/freeCodeCamp/ProjectReferenceData/master/cyclist-data.json', true)
                req.send()
                req.onload = () => {
                    const data = JSON.parse(req.responseText)
                    const w = 1000
                    const h = 600
                    const padding = 60
                    const topPadding = 20;

                    const xScale = d3.scaleLinear()
                                    .domain([d3.min(data, d => d.Year - 1), d3.max(data, d => d.Year + 1)])
                                    .range([padding, w - padding])
                    
                    console.log(d3.extent(data, d => d.Time));
                    const yScale = d3.scaleTime()
                                    .domain(d3.extent(data, d => {
                                        const time = d.Time.split(':')
                                        return new Date(1970, 1, 1, 0, time[0], time[1])
                                    }))
                                    .range([topPadding, h-padding])
                    
                    const xAxis = d3.axisBottom(xScale)
                                    .tickFormat(d3.format('d'))
                    
                    const yAxis = d3.axisLeft(yScale)
                                    .tickFormat(d3.timeFormat('%M:%S'))


                    const svg = d3.select('.graph')
                        .append('svg')
                        .attr('width', w)
                        .attr('height', h)

                    svg.append('g')
                        .attr('transform', 'translate(0,'+ (h - padding) +')')
                        .call(xAxis)
                        .attr('id', 'x-axis')
        
                    svg.append('g')
                        .attr('transform', 'translate('+padding+',0)')
                        .call(yAxis)
                        .attr('id','y-axis')

                }
            </script>
        </div>
    </body>
</html>